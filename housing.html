<html>

<head>
	<title>Housing</title>
	<link rel="stylesheet" href="housing.css">
	<link href="https://fonts.googleapis.com/css?family=Manjari|Source+Sans+Pro&display=swap" rel="stylesheet">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="https://d3js.org/d3-dsv.v2.min.js"></script>
	<script src="https://d3js.org/d3-fetch.v2.min.js"></script>
	<script>
		$.getJSON("upgrades.json", function(json) {
			localStorage.setItem("programStart", json.programStart);
			localStorage.setItem("programEnd", json.programEnd);
		});
	</script>
</head>


<body>

	<div class="topnav">
		<img src="SPIS-logo.jpg">
		<a class="tab" href="index.html">Home</a>
		<a class="tab" href="academic.html">Academic Program</a>
		<a class="tab" href="calendar.html">Calendar</a>
		<a class="tab" href="people.html">People</a>
		<a id="active" class="tab" href="housing.html">Housing</a>
		<a class="tab" href="highlights.html">Highlights</a>
		<a class="tab" href="enrollment.html">Enrollment</a>
		<a class="tab" href="resources.html">Resources</a>
	</div>

	
	<div class="info">
		<div class="housing">
			<h1>Student Housing</h1>
			<h2>
				<script>
					var data;
					d3.csv("housing.csv").then(function(result) {
						data = result;
						var housing = "";
						
						for(i = 0; i < data.length; i++){
							housing+= "<p>";
							housing+= data[i].Intro;
							housing+= "</p>";
							
							while(data[i].Intro.includes('<')) {
								var varNameStart = data[i].Intro.indexOf('<');
								var varNameEnd = data[i].Intro.indexOf('>');
						
								var varName = data[i].Intro.substring(varNameStart + 1, varNameEnd);
								var v = localStorage.getItem(varName);
								var original = data[i].Intro.substring(varNameStart, varNameEnd + 1);
								var replacement = v;
		
								housing = housing.replace(original, replacement);

								data[i].Intro = data[i].Intro.replace("<", "");
								data[i].Intro = data[i].Intro.replace(">", "");
							}
						}
		
						for(i = 0; i < data.length; i++) {
							housing+= "<p><b class='title'>";
							housing+= data[i].Title;
							housing+= "<br></b> ";
							housing+= data[i].Details;
							housing+= "</p>";

							while(data[i].Details.includes('\\')) {
								housing = housing.replace("\\", "<br>");
								data[i].Details = data[i].Details.replace("\\", "");
							}
						}
						housing+= "<br>";

						$("housing").html(housing);	
					});
				</script>
				<housing></housing>
				
				<div class="buttons"><a href="https://" onclick="location.href=this.href+mapLink;return false;"><button>Map</button></a><br></div>
				<div class="buttons"><a href="https://" onclick="location.href=this.href+faq;return false;"><button>FAQs</button></a></div>

			</h2>
		</div>


		<div class="dining">
			<h1>Dining</h1>
			<h2>
				<script>
					var data;
					var dining = "";
					d3.csv("dining.csv").then(function(result) {
						data = result;
						var j = 0;
						for(i = 0; i < data.length; i++){
							dining+= "<p>";
							dining+= data[i].Intro;
							dining+= "</p>";
							
							while(data[i].Intro.includes('<')) {
								var varNameStart = data[i].Intro.indexOf('<');
								var varNameEnd = data[i].Intro.indexOf('>');
						
								var varName = data[i].Intro.substring(varNameStart + 1, varNameEnd);
								var v = localStorage.getItem(varName);
								var original = data[i].Intro.substring(varNameStart, varNameEnd + 1);
								var replacement = v;
		
								dining = dining.replace(original, replacement);

								data[i].Intro = data[i].Intro.replace("<", "");
								data[i].Intro = data[i].Intro.replace(">", "");
							}
						}
		
						
						for(i = 0; i < data.length; i++){
							dining += "<li>";
							dining += data[i]['Location Bullets'];
		
							while(data[i]['Location Bullets'].includes("*")) {
								if (j == 0) {
									dining = dining.replace("*", "<ul> *");
									j++;
								}
		
								var bulletStart = data[i]['Location Bullets'].indexOf('*');
								var bulletEnd = data[i]['Location Bullets'].indexOf('*', bulletStart + 1);
		
								var bullet = data[i]['Location Bullets'].substring(bulletStart + 1, bulletEnd);	
								var original = data[i]['Location Bullets'].substring(bulletStart, bulletEnd);
								if(bulletEnd == -1) {
									bullet = data[i]['Location Bullets'].substring(bulletStart + 1);
									original = data[i]['Location Bullets'].substring(bulletStart);
								}
		
								var replacement = "<li type='circle' class='inner'>" + bullet + "</li>";
		
								dining = dining.replace(original, replacement);
		
								data[i]['Location Bullets'] = data[i]['Location Bullets'].replace('*', '');
							}

							if (data[i]['Location Bullets'].includes("'")) {
								var outerBulletStart = data[i]['Location Bullets'].indexOf("''");
								var outerBulletEnd = data[i]['Location Bullets'].indexOf("'", outerBulletStart);
								var outerBulletOriginal = data[i]['Location Bullets'].substring(outerBulletStart, outerBulletEnd);
								var outerBulletReplacement = data[i]['Location Bullets'].substring(outerBulletStart + 1, outerBulletEnd);
								console.log(outerBulletOriginal);
								console.log(outerBulletReplacement);
								dining = dining.replace(outerBulletOriginal, "<li type='circle' class='inner'>" + outerBulletReplacement + "</li>");
	
								dining+= "<ul>";
								while(data[i]['Location Bullets'].includes("'")) {
									var innerBulletStart = data[i]['Location Bullets'].indexOf("'");
									var innerBulletEnd = data[i]['Location Bullets'].indexOf("'", innerBulletStart + 1);
	
									var innerBullet = data[i]['Location Bullets'].substring(innerBulletStart + 1, innerBulletEnd);	
									
									var innerOriginal = data[i]['Location Bullets'].substring(innerBulletStart, innerBulletEnd + 2);
									var innerReplacement = "<li type='square' class='inner2'>" + innerBullet + "</li>";
	
									dining = dining.replace(innerOriginal, innerReplacement);
	
									data[i]['Location Bullets'] = data[i]['Location Bullets'].replace("'", "");
									data[i]['Location Bullets'] = data[i]['Location Bullets'].replace("'", "");
								}
								dining += "</ul>";
							
							}
							
							dining += "</ul></li>";
						}
						
						for (i = 0; i < data.length; i++){
							dining+= "<p>";
							dining+= data[i].Closing;
							dining+= "</p>";
							
						}
						
						dining += "<p><b class='title'>Special Meal Accomodations</b></p>";
						for (i = 0; i < data.length; i++){
							dining += "<p>";
							dining += data[i]["Special Meal Accomodations"];
							dining += "</p>";

							var wordStart = dining.indexOf("[");
							var wordEnd = dining.indexOf("]");
							var word = dining.substring(wordStart+1, wordEnd);
							
							var linkStart = dining.indexOf("{");
							var linkEnd = dining.indexOf("}");
							var link = dining.substring(linkStart+1, linkEnd);
							dining = dining.replace(dining.substring(wordStart, linkEnd+1), "<a href='" + link + "'>" + word + "</a>")
						}
						
						$("dining").html(dining);	
						
					});
				</script>
				<dining></dining>
			</h2>
		</div>
	</div>

	<script src="upgrade.js"></script>

</body>
</html>



